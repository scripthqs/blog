# 路由

## 路由简介

路由在生活中如拨打服务电话时，按数字几能处理什么样的处理，它就是类似于按键与服务之间的**映射**关系。在 Express 中，**路由指的就是客户端发起的请求与服务器端处理方法之间的映射关系**。映射就是一一对应的关系。

![路由](./images/router.png)

## 定义路由

express 中的路由分 3 部份组成，分别是请求**类型（方法）、请求 uri（地址）和对应的处理函数**。

当一个客户端请求到达服务端之后，先经过路由规则匹配，只有匹配成功之后，才会调用对应的处理函数。在匹配时，会**按照路由的顺序进行匹配**，如果**请求类型和请求的 URL 同时匹配成功**，则 Express 会将这次请求，转交给对应的函数进行处理。

```js
app.<get/post/put/delete/use>(uri,(req,res)=>{})
// use方法并不是请求类型方法，但是它放的位置与请求方法一致
```

## 路由模块化（重点）

含义：将原本可能写在一个文件中的路由规则，**拆分**成若干个路由文件（js 文件，一个 js 文件就是一个模块）。

顾名思义，将路由进行模块化，**以模块（js 文件）为单位进行管理，物以类聚**。

核心思想：能拆就拆（拆到不能拆为止，解耦，高内聚，低耦合）。

在开发项目时，如果将所有的路由规则都挂载到入口文件中，程序编写和维护都变得更加困难。所以 express 为了路由的模块化管理功能，通过 express.Router()方法创建路由模块化处理程序，可以将不同业务需求分开到不同的模块中，从而便于代码的维护和项目扩展。

路由模块化处理可以分为以下步骤来完成

- 创建独立 js 空白文件（最后是统一放在一个目录下）
  - 该文件即路由`模块化`文件
- 在第一步 js 文件中使用`express.Router()`方法创建路由模块对象
- 使用路由对象完成路由规则的对应的业务编写
- 使用模块化导出（`module.exports = router`）
- 在主入口文件中能够使用 app.use 方法来注册定义的路由模块
  - 支持前缀的使用
  - app.use("前缀",路由模块化路由)

```js
//1.创建出空白的js文件，引入express
const express = require('express')
//2.在第一步js文件中使用express.Router()方法创建路由模块对象
const router = express.Router()
//3.使用路由对象完成路由规则的对应的业务编写
.......
//4.使用模块化导出
module.exports= router
//5.在主入口文件中能够使用app.use方法来注册定义的路由模块
```
